syntax = "proto3";

package wss;

// 基础
message Base {
	string id = 1;
	string cmd = 2;
}

// 标签
message Tag {
	uint64 id = 1; // 标签ID(貌似)
	string text = 3;
	string color = 4;
}

// 心跳包
message heartbeat_ack_info {
	Base base = 1;
}

// 草稿同步
message draft_input {
	Base base = 1;
	Data data = 2;

	message Data {
		string any = 1;
		Draft draft = 2;

		message Draft {
			string chat_id = 1; // 对象ID
			string input = 2; // 草稿内容
		}
	}
}

// ws推送消息
message push_message {
	Base base = 1;
	Data data = 2;

	message Data {
		string any = 1;
		Msg msg = 2;

		message Msg {
			string msg_id = 1;
			Sender sender = 2;
			string recv_id = 3; // 接收者ID
			string chat_id = 4; // 会话的ID
			uint64 chat_type = 5; // 会话类型
			Content content = 6; // 消息内容
			uint64 content_type = 7;
			uint64 timestamp = 8; // 时间戳(毫秒)
			Cmd cmd = 9; // 指令
			uint64 delete_timestamp = 10; // 撤回消息时间,和8差别不大
			string quote_msg_id = 11; // 引用消息ID
			uint64 msg_seq = 12; // 消息序列,在撤回时也是被撤回消息的序列

			message Cmd {
				uint64 id = 1; // 命令ID
				string name = 2; // 命令名称
			}

			message Sender {
				string chat_id = 1;
				uint64 chat_type = 2;
				string name = 3;
				string avatar_url = 4;
				repeated string tag_old = 6;
				repeated Tag tag = 7;
			}

			message Content {
				string text = 1; // 消息内容
				string buttons = 2; // 按钮
				string image_url = 3;
				string file_name = 4;
				string file_url = 5;
				string form = 7; // 表单消息
				string quote_msg_text = 8; // 引用消息文字
				string sticker_url = 9; // 表情URL
				string post_id = 10; // 文章ID
				string post_title = 11; // 文章标题
				string post_content = 12; // 文章内容
				string post_content_type = 13; // 文章类型
				string expression_id = 15; // 个人表情ID(不知道为啥为STR)
				string quote_image_url = 16; // 引用图片直链,https://...
				string quote_image_name = 17; // 引用图片文件名称
				uint64 file_size = 18; // 文件/图片大小(字节)
				string video_url = 19; // 视频URL
				string audio_url = 21; // 语音URL
				uint64 audio_time = 22; // 语音时长
				string quote_video_url = 23; // 引用视频直链,https://...
				uint64 quote_video_time = 24; // 引用视频时长
				uint64 sticker_item_id = 25; // 表情ID
				uint64 sticker_pack_id = 26; // 表情包ID
				string call_text = 29; // 语音通话文字
				string call_status_text = 32; // 语音通话状态文字
				uint64 width = 33; // 图片的宽度
				uint64 height = 34; // 图片的高度
				string tip = 37; // 提示信息
			}
		}
	}
}

// 超级文件分享
message file_send_message {
	Base base = 1;
	Data data = 2;

	message Data {
		string any = 1;
		Sender sender = 2;

		message Sender {
			string send_user_id = 1; // 分享者用户ID
			string user_id = 2; // 接收者用户ID
			uint64 temp_code = 3; // 未知
			string send_type = 4; // 分享类别区分文本
			string data = 5; // 经过转义后的json格式发送数据
			string send_deviceId = 6; // 发送者设备唯一标识符
		}
	}
}

// ws接收编辑消息
message edit_message {
	Base base = 1;
	Data data = 2;

	message Data {
		string any = 1;
		Msg msg = 2;
		message Msg {
			string msg_id = 1;
			string recv_id = 3; // 接收者ID,但是不知道为啥到编辑这里就和4一样了
			string chat_id = 4; // 会话的ID
			Content content = 6; // 消息内容
			uint64 content_type = 7;
			string quote_msg_id = 11; // 引用消息ID
			uint64 edit_time = 14; // 编辑时间

			message Content {
				string text = 1; // 消息内容
				string buttons = 2; // 按钮
				string quote_msg_text = 8; // 引用消息文字
			}
		}
	}
}
